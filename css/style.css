@view-transition {
  navigation: auto;
}

@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  /* https://kilianvalkhof.com/2022/css-html/your-css-reset-needs-text-size-adjust-probably/ */
  html {
    -moz-text-size-adjust: none;
    -webkit-text-size-adjust: none;
    text-size-adjust: none;
  }

  body,
  h1,
  h2,
  h3,
  h4,
  p,
  figure,
  blockquote,
  dl,
  dd {
    margin: 0;
  }

  ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  body {
    min-block-size: 100vh;
    line-height: 1.6;
  }

  h1,
  h2,
  h3,
  h4,
  button,
  input {
    line-height: 1.1;
  }

  h1,
  h2,
  h3,
  h4 {
    text-wrap: balance;
  }

  p {
    text-wrap: pretty;
  }

  img,
  picture {
    max-inline-size: 100%;
    height: auto;
    vertical-align: middle;
    background-repeat: no-repeat;
    background-size: cover;
    shape-margin: 1rem;
    font-style: italic;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
  }
}

@layer base {
  @layer root {
    :root {
      /* ============  Primitive Tokens ============ */
      --clr-white: hsl(0, 100%, 100%);
      --clr-blue-900: hsl(209, 23%, 22%);
      --clr-blue-950: hsl(207, 26%, 17%);
      --clr-grey-50: hsl(0, 0%, 99%);
      --clr-grey-400: hsl(0, 0%, 50%);
      --clr-grey-950: hsl(200, 15%, 8%);

      --fs-100: clamp(0.75rem, 0.706rem + 0.188vi, 0.875rem);
      --fs-200: clamp(0.75rem, 0.662rem + 0.376vi, 1rem);
      --fs-300: 0.875rem;
      --fs-400: 1rem;
      --fs-500: 1.125rem;
      --fs-600: clamp(0.875rem, 0.655rem + 0.939vi, 1.5rem);
      --fs-700: clamp(1.5rem, 1.324rem + 0.751vi, 2rem);

      --line-height: 1.35;
      --ff-body: 'Nunito Sans', sans-serif;

      /* ============ Semantic Tokens ============ */
      --bg-main: var(--clr-grey-50);
      --bg-element: var(--clr-white);
      --text-main: var(--clr-grey-950);
      --input-border: var(--clr-grey-400);
      --button-bg: var(--clr-blue-950);

      --font-size-xs: var(--fs-100);
      --font-size-sm: var(--fs-200);
      --font-size-md: var(--fs-300);
      --font-size-base: var(--fs-400);
      --font-size-lg: var(--fs-500);
      --font-size-xl: var(--fs-600);
      --font-size-2xl: var(--fs-700);

      /* ====== Icon config ====== */
      --sun-color: var(--clr-white);
      --moon-color: var(--clr-blue-950);
      --sun-stroke: var(--clr-white);
      --moon-stroke: var(--clr-blue-950);
      --sun-stroke-width: 8;
      --moon-stroke-width: 6;

      --radius-sm: 0.125rem;
      --radius: 0.3125rem;
      --radius-lg: 0.625rem;
      --shadow: 0px 2px 4px hsla(0, 0%, 0%, 0.056);
      --shadow-lg: 0px 2px 9px hsla(0, 0%, 0%, 0.056);
    }

    /* Dark theme */
    [data-theme='dark'] {
      --bg-main: var(--clr-blue-950);
      --bg-element: var(--clr-blue-900);
      --text-main: var(--clr-white);
      --button-bg: var(--clr-white);
      /* --button-color: -- */
    }
  }

  @layer general-styling {
    html {
      font-family: var(--ff-body);
      line-height: var(--line-height);
    }

    body {
      font-size: var(--font-size-base);
      background-color: var(--bg-main);
      color: var(--text-main);
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    a {
      text-decoration: none;
      color: inherit;
    }
  }
}

@layer layout {
  .flex-group {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--flex-gap);
    flex-wrap: wrap;
  }

  .wrapper {
    --wrapper-max-width: 90rem;
    --wrapper-padding: 2rem;

    inline-size: min(100% - var(--wrapper-padding), var(--wrapper-max-width));
    max-inline-size: var(--wrapper-max-width);
    margin-inline: auto;

    &[data-padding='compact'] {
      --wrapper-padding: 7rem;
    }

    @media (width > 48rem) {
      --wrapper-padding: 5rem;

      &[data-padding='compact'] {
        --wrapper-padding: 10.5rem;
      }
    }

    @media (width > 64rem) {
      --wrapper-padding: 10rem;

      &[data-padding='compact'] {
        --wrapper-padding: 10rem;
      }
    }
  }
}

@layer components {
  .header {
    position: fixed;
    inset-block-start: 0;
    inset-inline-start: 0;
    inline-size: 100%;
    padding-block: 1.875rem;
    background-color: var(--bg-element);
    box-shadow: var(--shadow);
    z-index: 1000;
  }

  .header-title {
    font-size: var(--font-size-xl);
    font-weight: 800;
  }

  .theme-toggle {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-main);
    background-color: var(--bg-element);
    font-size: var(--font-size-sm);
    font-weight: 600;
    padding: 0;
    border: 0;
    cursor: pointer;

    .theme-icon {
      --icon-size: 1rem;

      position: relative;
      block-size: var(--icon-size);
      inline-size: var(--icon-size);

      .moon-ray {
        position: absolute;
        inset-block-start: 0;
        inset-inline-start: 0;
      }
    }
  }

  .hero {
    --flex-gap: 2.5rem 0.5rem;
    padding-block-start: 6.5rem;

    @media (width > 48rem) {
      padding-block-start: 8rem;
    }
  }

  .country {
    margin-block-start: var(--block-start, 2rem);
    margin-block-end: var(--block-end, 4rem);

    @media (width > 48rem) {
      --block-start: 3rem;
      --block-end: 3.5rem;
    }

    @media (width > 64rem) {
      --block-end: 3rem;
    }
  }

  .country-search-wrapper {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    color: var(--text-main);
    background-color: var(--bg-element);
    inline-size: 100%;
    max-inline-size: 30rem;
    padding: 1rem 2rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow-lg);
    transition: box-shadow 0.2s ease;

    &:focus-within {
      box-shadow: 0 0 0 1px var(--input-border);
    }

    .country-search {
      border: 0;
      padding: 0;
      outline: none;
      inline-size: 100%;
      font-size: var(--font-size-xs);
      color: var(--text-main);
      background-color: var(--bg-element);

      &::placeholder {
        color: var(--text-main);
      }
    }
  }

  select {
    padding: 1rem 1.5rem;
    background-color: var(--bg-element);
    color: var(--text-main);
    font-size: var(--font-size-xs);
    box-shadow: var(--shadow-lg);
    border: 0;
    border-radius: var(--radius);
  }

  .country-grid {
    /* --grid-min-col-size: 16.5rem; */
    --grid-min-col-size: 13rem;
    --grid-gap: 2.5rem;

    display: grid;
    gap: var(--grid-gap);
    grid-template-columns: repeat(auto-fill, minmax(min(var(--grid-min-col-size), 100%), 1fr));

    @media (width > 48rem) {
      --grid-gap: 4.5rem;
    }
  }

  .country-card {
    display: grid;
    grid-template-rows: 1fr min-content;
    color: var(--text-main);
    background-color: var(--bg-element);
    border-radius: var(--radius);
    box-shadow: var(--shadow-lg);

    img {
      block-size: 100%;
      inline-size: 100%;
      border-top-left-radius: var(--radius);
      border-top-right-radius: var(--radius);
    }
  }

  .country-card__details {
    padding-block: 1.5rem 3rem;
    padding-inline: 1.5rem;
    font-size: var(--font-size-md);
    font-weight: 300;

    h3 {
      font-size: var(--font-size-lg);
      font-weight: 800;
      margin-block-end: 1rem;
    }

    p + p {
      margin-block-start: 0.5rem;
    }
  }

  .status-message {
    display: grid;
    justify-items: center;
    align-content: center;
    text-align: center;
    block-size: 50vh;
    z-index: 10;

    img {
      width: 10rem;
    }

    h2 {
      color: var(--text-main);
      font-size: 1.5rem;
      font-weight: 800;
    }

    p {
      color: var(--text-main);
      font-size: var(--font-size-sm);
      font-weight: 600;
    }
  }

  .bouncing-loader {
    position: absolute;
    inset-block-start: 50%;
    inset-inline-start: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;

    span {
      block-size: 0.75rem;
      inline-size: 0.75rem;
      margin-inline-start: 0.25rem;
      border-radius: 50%;
      background-color: var(--text-main);
      animation: loading 1s linear infinite;

      &:nth-child(1) {
        animation-delay: 0.1s;
      }

      &:nth-child(2) {
        animation-delay: 0.2s;
      }

      &:nth-child(3) {
        animation-delay: 0.3s;
      }

      &:nth-child(4) {
        animation-delay: 0.4s;
      }
    }
  }

  /* ============= Details Page ============= */

  .button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-main);
    background-color: var(--bg-element);
    line-height: 2;
    font-weight: 300;
    padding-block: 0.25rem;
    padding-inline: 2rem;
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow);
  }

  .country-info {
    --flex-gap: 3.5rem;
    margin-block-start: var(--block-start, 4rem);

    .country-flag {
      border-radius: var(--radius-lg);
    }

    .info-text {
      h2 {
        font-size: var(--font-size-2xl);
        margin-block-end: 1rem;
      }

      .stats-flex {
        display: flex;
        gap: 2rem;
        flex-wrap: wrap;

        p {
          line-height: 2;
        }
      }
    }

    @media (width > 48rem) {
      --block-start: 3.5rem;

      h2 {
        margin-block-end: 1.5rem;
      }
    }

    @media (width > 64rem) {
      --block-start: 5rem;
    }
  }

  .scroll-to-top.show {
    opacity: 0.6;
    pointer-events: auto;
  }

  .scroll-to-top {
    display: flex;
    justify-content: center;
    align-items: center;

    position: fixed;
    inset-block-end: 2rem;
    inset-inline-end: 2rem;
    inline-size: 2rem;
    block-size: 2rem;
    padding: 1rem;
    color: var(--bg-element);
    background-color: var(--button-bg);
    border-radius: var(--radius);
    opacity: 0;
    border: none;
    pointer-events: none;
    transition: opacity 0.3s ease;
    cursor: pointer;
    z-index: 500;

    &:hover {
      opacity: 1;
    }
  }
}

@layer utilities {
  [hidden] {
    display: none;
  }

  .origin-center {
    transform-origin: center;
  }

  .stat-label {
    display: inline-block;
    color: var(--text-main);
    font-weight: 600;
    margin-inline-end: 0.125rem;
  }

  .no-theme-transition * {
    transition: none;
  }

  .visually-hidden {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    inline-size: 0.0625rem;
    block-size: 0.0625rem;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
  }

  @keyframes loading {
    0% {
      transform: translateY(0);
    }

    25% {
      transform: translateY(0.5rem);
    }

    50% {
      transform: translateY(-0.5rem);
    }

    100% {
      transform: translateY(0);
    }
  }
}
